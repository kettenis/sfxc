dnl Process this file with autoconf to produce a configure script.
AC_INIT(JIVE software correlator, 0.0.3)
AC_CONFIG_AUX_DIR(config)
AM_CONFIG_HEADER(config.h)
AM_INIT_AUTOMAKE(sfxc, 0.0.2)

dnl Checks for programs.
AC_PROG_CC
AC_PROG_CXX
AC_PROG_F77
AC_PROG_INSTALL
AC_PROG_LIBTOOL
AC_PROG_YACC

AM_PROG_LEX

AC_LANG_CPLUSPLUS

dnl Checks for libraries.
AC_CHECK_LIB(fftw3, fftw_execute)
AC_CHECK_LIB(mpich, MPI_Init)
AC_CHECK_LIB(m, sin)
AC_CHECK_LIB(vex_parser, parse_vex)
AC_CHECK_HEADERS(boost/shared_ptr.hpp,,AC_MSG_ERROR([boost/shared_ptr.hpp header not found.]))

LIBS="$LIBS -ljson"
AC_CHECK_HEADERS(json/json.h,, \
                 AC_MSG_ERROR([json/json.h header not found.]))
AC_MSG_CHECKING(for the json library)
AC_TRY_LINK([
#include <json/json.h>
],[
Json::Value root;
],AC_MSG_RESULT(yes),AC_MSG_ERROR([
Unable to link to jsoncpp library. If you
just installed it: try running ldconfig
as root]))


LIBS="$LIBS -lgsl -lgslcblas"
AC_CHECK_HEADERS(gsl/gsl_spline.h,, \
                 AC_MSG_ERROR([gsl/gsl_spline.h header not found.]))


dnl export these variable (so Makefile substitutions
dnl can be made. 
AC_SUBST(CXXFLAGS)
AC_SUBST(LDFLAGS)

AC_OUTPUT(Makefile
          lib/Makefile
          lib/calc10/Makefile
          lib/calc10/lib/Makefile
          lib/calc10/src/Makefile
          lib/vex_parser/Makefile
          src/Makefile
          src/multicore/Makefile
          test/Makefile
          include/Makefile
          utils/Makefile
          utils/vex_parser/Makefile
          doc/Makefile
          doc/html/Makefile
         )
